$(function(){$("#wpa").on("click",function(){$("#qq_frame").attr("src",$("#qq_link").attr("href"));});$("body").on("click",".involvement-process a",function(j){j.stopPropagation();h();});$("body").on("click","#processLegend .confirm-close",function(j){j.stopPropagation();h();});$("body").on("click","#processLegend",function(j){j.stopPropagation();});$("body").on("click",function(){$(".involvement-process a").removeClass("cur");$("#processLegend").addClass("dn");});function h(){$(".involvement-process a").toggleClass("cur");$("#processLegend").toggleClass("dn");}function e(){var n=$.cookie("compares");if(n!=null){var m=n.split("|");for(var l=0;l<m.length;l++){var k=m[l];if(k&&k.split(",").length==3&&k[0]&&k[0]!="null"){var j=k.split(",");if(j[0]=="NEWHOUSE"&&j[2]==gardenId){}}}}}e();$("#bannerFullWidth").qfangBanner({showBtns:false,time:"5000"});$(window).on("resize",function c(){$(".bgi-big").refitImage({maxWidth:$(window).width(),maxHeight:592});}).trigger("resize");$("#photoAlbum").qfangPhotoAlbum({hideTit:"true",initNum:4,space:0,callback:function(j){j.attr("style","").refitImage({maxWidth:690,maxHeight:360});}});var g=$("#anchorNavBox");var b=$("#anchorNav");var f=$(".anchor-trigger[id^=scrollto-]:eq(0)").offset().top;var d=b.outerHeight();var i=700;if($(".newhs-details-banner:visible")){i=890;}jQuery.scrollto=function(k,j){$(k).click(function(){var l=$(this).attr("date-scroll");var m=Math.ceil($(l).offset().top-d);$("html,body").animate({scrollTop:m},j);return false;});};$.scrollto("#anchor-6,#anchor-1,#anchor-2,#anchor-3,#anchor-4,#anchor-5,#anchor-7",1);function a(){var p=$(window).scrollTop();var k=b.find('li[data-type="anchor"]').find("a");var n=[];$.each(k,function(r,j){n.push($(this).attr("id").replace(/anchor-/g,""));});var o=[];for(var m=0;m<n.length;m++){o.push(Math.ceil($("#scrollto-"+n[m]).offset().top-d));}function q(r,j){return r-j;}o.sort(q);for(var l=o.length-1;l>=0;l--){if(p==$(document).height()-$(window).height()){b.find('li[data-type="anchor"]').eq(o.length-1).addClass("cur").siblings().removeClass("cur");break;}if(p>=o[l]){b.find('li[data-type="anchor"]').eq(l).addClass("cur").siblings().removeClass("cur");break;}}}winScrollFun=function(){var j=$(window).scrollTop();if(j>=f){b.addClass("anchor-nav-fixed");}else{if(j<f-50){b.removeClass("anchor-nav-fixed");}}if(j>=(f+(+($(".latest-preferential:visible").height())))){$("#brokerO2o").addClass("fixed").fadeIn();}else{if(j<f-50+(+($(".latest-preferential:visible").height()))){$("#brokerO2o").hide().removeClass("fixed");}}a();};showHideBrokerO2o=function(){var m=$("#brokerO2o");var l=$(window).scrollTop();var j=$('[data-type="reference"]').offset().top;var k=m.outerHeight();if((j-l)<=k){m.removeClass("fixed").addClass("absolute").css({"top":j-k-i-(+($(".latest-preferential:visible").height()))});}else{m.removeClass("absolute").css({"top":32});}};$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();$("body").on("click",'[name="moreNews"]',function(){$(this).parent().parent().find("div").removeClass("dn");$(this).parent().addClass("dn");});$("body").on("click",'[name="closeMoreNews"]',function(){$(this).parent().parent().find("div").removeClass("dn");$(this).parent().addClass("dn");});$("#addressLink").on("click",function(){$("html,body").animate({scrollTop:$("#scrollto-3").offset().top-40},1);});$("body").on("click",".newhs-dmf-tabs a",function(){if(!$(this).hasClass("cur")){$(this).addClass("cur").siblings().removeClass("cur");}});$("body").on("click",".view-layout-image",function(){var q=$(this);var m=q.closest("li").find(".layout-img-items");var p=[];m.find("img").each(function(){p.push({src:$(this).attr("src")});});$.qfangLightbox({photoArr:p,description:function(s,r){return s+"/共"+r.length+"张";},firstTipsFun:function(){$.qfangAlertTips.Help("此照片已经是第一张哦",1000);$(".hq-photo").find(".hq-photo-prev").addClass("hq-photo-prev-dis");},lastTipsFun:function(){$.qfangAlertTips.Help("此照片已经是最后一张哦",1000);$(".hq-photo").find(".hq-photo-next").addClass("hq-photo-next-dis");},onClick:j,afterRender:o});function o(r){$(".hq-photo-inner").before(q.closest("li").find(".hq-photo-classified").clone());$(".hq-photo .hq-photo-classified").removeClass("dn");$("body").on("click",".view-layout-img",function(){var u=$(this);var t=u.data("typeWrapper");var s=$("."+u.data("detail"));r.activeNum=s.find('img[data-type="'+t+'"]:eq(0)').data("active");r.switchStatus();});}var n=[];for(var k=p.length-1;k>=0;k--){var l=m.find('img[src="'+p[k].src+'"').data("type");n.push({type:l,src:p[k].src});}function j(r){var u=r.photoArr[r.activeNum-1];var t="";for(var s=n.length-1;s>=0;s--){if(n[s].src==u.src){t=n[s].type;}}if(t){$(".hq-photo .hq-photo-classified span.cur").removeClass("cur");$('.hq-photo .view-layout-img[data-type-wrapper="'+t+'"]').addClass("cur");}}});$("body").on("click","#remainingDMF",function(){if(!$(this).find("i").hasClass("opened")){$(this).html('<span>收起</span><i class="icons-listings opened"></i>');$("#newhsDMF li").removeClass("dn");}else{var j=$("#newhsDMF").attr("flg")-3;$("#newhsDMF li").filter(":gt(2)").addClass("dn");$(this).html('<a href="javascript:;"><span>点击查看剩余'+j+'套户型图</span><i class="icons-listings"></i></a>');$("html,body").animate({scrollTop:$("#scrollto-1").offset().top-43},1);}});initLayoutTable("all");initNewsTable(1,3,false);initPhotoTable("all",1,4,false);if(typeof(sourceCity)!="undefined"&&typeof(originalCity)!="undefined"&&sourceCity!=null&&originalCity!=null&&sourceCity!=originalCity){}else{initAroundsTable();initSimilarPricesTable();initAroundRoomsTable();}addNewHouseClick(newhouseID,gardenName);});function initLayoutTable(b){var a="";if(typeof(sourceCity)!="undefined"){a=sourceCity;}$.ajax({url:ctx+"/newhousedetail/getLayOutPage/"+b+"/"+gardenId,dataType:"text",data:{pageSize:100,currentPage:1,sourceCity:a},success:function(c){if(c!=null&&$.trim(c)!=""){$("#scrollto-1").html(c);$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();$("#remainingDMF").on("click",function(){if($(this).hasClass("closed")){$("html,body").animate({scrollTop:$("#scrollto-1").offset().top-40},1);}});}else{$("#anchor-1").parent().attr("data-type","").hide();$("#scrollto-1").hide();$("#anchorNav li").not(":hidden").eq(0).addClass("cur");$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}}});}function initPhotoTable(d,e,b,c){var a="";if(typeof(sourceCity)!="undefined"){a=sourceCity;}$.ajax({url:ctx+"/newhousedetail/getPhotoPage/"+d+"/"+gardenId,dataType:"text",data:{pageSize:b,currentPage:e,sourceCity:a},success:function(f){if(f!=null&&$.trim(f)!=""){$("#scrollto-2").html(f);$("#hsPics img").refitImage({maxWidth:346,maxHeight:260});$("#hsPics").on("click","a",function(){var j=$(this);var g=j.parent().parent();var i=[];var h;g.find("img").each(function(){i.push({src:$(this).attr("data-src"),type:$(this).attr("data-type")});});h=j.children().attr("data-active");$.qfangLightbox({photoArr:i,activeNum:h,description:function(l,k){return l+"/共"+k.length+"张"+"（"+k[l-1].type+"）";},firstTipsFun:function(){$.qfangAlertTips.Help("此照片已经是第一张哦",1000);},lastTipsFun:function(){$.qfangAlertTips.Help("此照片已经是最后一张哦",1000);}});});$(window).bind("scroll",winScrollFun);winScrollFun();if(c){$("html,body").animate({scrollTop:$("#scrollto-2").offset().top-40},1);}$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}else{$("#anchor-2").parent().attr("data-type","").hide();$("#scrollto-2").hide();$("#anchorNav li").not(":hidden").eq(0).addClass("cur");$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}}});}function initAroundsTable(){$.ajax({url:ctx+"/newhousedetail/getDetailAjaxData/aroundNewhouses/"+gardenId,dataType:"text",success:function(a){$("#scrollto-5").html(a);$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}});}function initSimilarPricesTable(){$.ajax({url:ctx+"/newhousedetail/getDetailAjaxData/similarPrice/"+gardenId,dataType:"text",success:function(a){$("#similarPrices").html(a);$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}});}function initAroundRoomsTable(){$.ajax({url:ctx+"/newhousedetail/getDetailAjaxData/aroundRooms/"+gardenId,dataType:"text",success:function(a){$("#aroundRooms").html(a);$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}});}function addNewHouseClick(b,a){$.post(ctx+"/newhouse/newHouseClickCount",{newhouseID:b,gardenName:a},function(){});}function initNewsTable(d,b,c){var a="";if(typeof(sourceCity)!="undefined"){a=sourceCity;}$.ajax({url:ctx+"/newhousedetail/getNewsPage/"+gardenId,dataType:"text",data:{sourceCity:a,pageSize:b,currentPage:d},success:function(e){if(e!=null&&$.trim(e)!=""){$("#scrollto-6").html(e);$(window).bind("scroll",winScrollFun);winScrollFun();if(c){$("html,body").animate({scrollTop:$("#scrollto-6").offset().top-40},1);}$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}else{$("#anchor-6").parent().attr("data-type","").hide();$("#scrollto-6").hide();$("#anchorNav li").not(":hidden").eq(0).addClass("cur");$(window).bind("scroll",winScrollFun);winScrollFun();$(window).on("scroll",showHideBrokerO2o);showHideBrokerO2o();}}});}function addLayoutPicCount(a,b){$.post(ctx+"/newhousedetail/layoutPicClickCount/"+a+"/"+b,{},function(){});}function resetBrokerTel(a){$('input[name="brokerMobile"]').val(a);}